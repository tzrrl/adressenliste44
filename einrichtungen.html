<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Einrichtungsverzeichnis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals -->
    <!-- Application Structure Plan: Die Anwendung ist als interaktives Dashboard konzipiert. Oben befinden sich zentrale Filter- und Suchfunktionen (nach Name, Träger, Stadt). Darunter werden dynamische Statistiken (Anzahl der Einrichtungen) und eine visuelle Aufschlüsselung nach Trägern (Donut-Diagramm) angezeigt. Der Hauptbereich listet die Einrichtungen als einzelne Karten auf. Diese Struktur wurde gewählt, um Benutzern einen schnellen Überblick zu ermöglichen (Dashboard-Elemente) und gleichzeitig eine detaillierte, gefilterte Suche zu erlauben (Kartenliste). Die Interaktionen (Suche, Filter) aktualisieren alle Elemente der Seite in Echtzeit, was eine nahtlose und intuitive Benutzerführung gewährleistet. -->
    <!-- Visualization & Content Choices: 1. Adressliste -> Ziel: Organisieren/Informieren -> Präsentation: Interaktive Karten in einem Grid-Layout -> Interaktion: Die Liste wird über Textsuche und Dropdown-Menüs gefiltert. Begründung: Karten sind visuell ansprechender und auf mobilen Geräten besser lesbar als eine Tabelle. Methode: HTML/CSS mit Tailwind, dynamisch gerendert durch JavaScript. 2. Trägerverteilung -> Ziel: Vergleichen/Informieren -> Präsentation: Donut-Diagramm -> Interaktion: Das Diagramm aktualisiert sich basierend auf den gesetzten Filtern. Begründung: Ein Donut-Diagramm zeigt Anteile und Verhältnisse auf einen Blick. Bibliothek: Chart.js (Canvas). 3. Gesamtzahl -> Ziel: Informieren -> Präsentation: Dynamische Kennzahl -> Interaktion: Die Zahl ändert sich in Echtzeit mit jeder Filteranpassung. Begründung: Gibt dem Nutzer direktes Feedback über die Ergebnisse seiner Filterung. Methode: JavaScript. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #fdfdfc;
            color: #333;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .card {
            background-color: #ffffff;
            border: 1px solid #e5e7eb;
            transition: box-shadow 0.3s ease-in-out, transform 0.3s ease-in-out;
            will-change: transform;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800">Interaktives Einrichtungsverzeichnis</h1>
            <p class="mt-2 text-lg text-gray-600">Finden, filtern und analysieren Sie Einrichtungen</p>
        </header>

        <main>
            <div class="bg-white rounded-lg shadow-md p-4 sm:p-6 mb-8 border border-gray-200">
                <p class="text-gray-700 mb-4">
                    Nutzen Sie die Such- und Filteroptionen, um die Liste der Einrichtungen zu durchsuchen. Die Übersicht und die Kartenliste werden bei jeder Änderung automatisch aktualisiert, um Ihnen stets die relevantesten Informationen anzuzeigen.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <input type="search" id="searchInput" placeholder="Suche nach Name, Ansprechpartner..." class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition">
                    <select id="orgFilter" class="w-full p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition">
                        <option value="">Alle Träger</option>
                    </select>
                    <select id="cityFilter" class="w-full p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition">
                        <option value="">Alle Städte</option>
                    </select>
                </div>
            </div>

            <section id="dashboard" class="mb-8 grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-1 bg-white p-6 rounded-lg shadow-md border border-gray-200 flex flex-col justify-center items-center text-center">
                     <h2 class="text-xl font-semibold text-gray-700 mb-2">Einrichtungen (gefiltert)</h2>
                    <p id="statsCount" class="text-6xl font-bold text-amber-600">0</p>
                    <p class="text-gray-500 mt-2">Treffer für Ihre Auswahl</p>
                </div>
                <div class="lg:col-span-2 bg-white p-6 rounded-lg shadow-md border border-gray-200">
                    <h2 class="text-xl font-semibold text-gray-700 text-center mb-4">Verteilung nach Trägern</h2>
                     <div class="chart-container">
                        <canvas id="orgChart"></canvas>
                    </div>
                </div>
            </section>

            <section id="results" class="bg-gray-50 p-4 sm:p-6 rounded-lg border border-gray-200">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Einrichtungen</h2>
                <div id="resultsGrid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
                </div>
            </section>

        </main>
    </div>

    <script>
        const data = [
            { name: "Rüstkäuer Rasselbande", org: "Stadt Schüttorf", contacts: "Nicole Beitzel (L) / Steffi Schraten", address: "Rüstkau 2, 48465 Schüttorf" },
            { name: "Haus des Kindes", org: "Stadt Lingen", contacts: "Almut Kewitz (L) / Doris Roß", address: "Werner-von-Siemens-Straße 21, 49808 Lingen" },
            { name: "Heideweg", org: "Rappelkiste", contacts: "Anne Zinke (L) / Anne Zinke", address: "Heideweg 10, 48529 Nordhorn" },
            { name: "denn kläijnen Hoff", org: "Rappelkiste", contacts: "Christian Pump (L) / Anne Kotman", address: "Döppersweg 11, 48531 Nordhorn" },
            { name: "St. Michael", org: "kath.", contacts: "Christine Navarro (L) / Andrea Tix-Knoll", address: "Langschmidtsweg 66 a, 49808 Lingen" },
            { name: "St. Barbara", org: "kath.", contacts: "Hanne Kohne (L) / Nikola Hofschlag", address: "Thüringer Straße 27, 49809 Lingen" },
            { name: "St. Antonius", org: "kath.", contacts: "Kerstin Lüken-Stoke (L)", address: "Kirchenkamp 14, 49811 Lingen" },
            { name: "Sonnenwald", org: "K.I.T.A. gGmbH", contacts: "Imke Wolf (L) / Carolina Fillinger", address: "Wilhem Rabe Straße 54, 48527 Nordhorn" },
            { name: "Wirbelwind", org: "K.I.T.A. gGmbH", contacts: "Nicole Lüthe (L) / Gudrun Koop", address: "Von Behring Straße 7, 48529 Nordhorn" },
            { name: "Mauerstraße", org: "ev-ref.", contacts: "Berndine Kethorn (L) / Daniela Brünemeyer", address: "Mauerstraße 44, 48465 Schüttorf" },
            { name: "Wietkampstrolche", org: "ev-ref.", contacts: "Sandra Kuhlmann (L) / Stefanie Fischer", address: "Bauweg 13, 48465 Schüttorf" },
            { name: "Kita Lutherherz", org: "ev-luth. Gemeinde", contacts: "Sabrina Beer (L) / Nadine Kip", address: "Bäumerstraße 16, 49808 Lingen" },
            { name: "Joahneskita", org: "ev-luth. Gemeinde", contacts: "Ulrike Pötter (L) / Gabi Lefers", address: "Prinzenstraße 15, 49828 Neuenhaus" },
            { name: "Trinitatis", org: "ev-luth. Gemeinde", contacts: "Daniel Fleddermann(L) / Ortun Elison", address: "Kuckuckstraße 23, 49808 Lingen" },
            { name: "Arche Noah", org: "ev-luth. Gemeinde", contacts: "Sarah Hauptmeier (L) / Rita Spieker", address: "Westersand 3, 49824 Emlichheim" },
            { name: "Schatzkiste", org: "DRK", contacts: "Sigrid Jakobs (L) / Claudia Herms", address: "Schillerstraße 27, 48465 Schüttorf" }
        ];

        document.addEventListener('DOMContentLoaded', () => {
            const searchInput = document.getElementById('searchInput');
            const orgFilter = document.getElementById('orgFilter');
            const cityFilter = document.getElementById('cityFilter');
            const resultsGrid = document.getElementById('resultsGrid');
            const statsCount = document.getElementById('statsCount');
            const orgChartCanvas = document.getElementById('orgChart');
            let chart;

            const getCityFromAddress = (address) => {
                const match = address.match(/\d{5}\s(.+)/);
                return match ? match[1] : 'Unbekannt';
            };

            const organizations = [...new Set(data.map(item => item.org))];
            organizations.sort().forEach(org => {
                const option = document.createElement('option');
                option.value = org;
                option.textContent = org;
                orgFilter.appendChild(option);
            });
            
            const cities = [...new Set(data.map(item => getCityFromAddress(item.address)))];
            cities.sort().forEach(city => {
                const option = document.createElement('option');
                option.value = city;
                option.textContent = city;
                cityFilter.appendChild(option);
            });

            function renderResults(filteredData) {
                resultsGrid.innerHTML = '';
                if (filteredData.length === 0) {
                    resultsGrid.innerHTML = '<p class="text-gray-500 md:col-span-2 xl:col-span-3 text-center">Keine Einrichtungen für die aktuelle Auswahl gefunden.</p>';
                } else {
                    filteredData.forEach(item => {
                        const card = document.createElement('div');
                        card.className = 'card p-5 rounded-lg';
                        card.innerHTML = `
                            <h3 class="text-lg font-bold text-gray-800">${item.name}</h3>
                            <p class="text-sm text-amber-700 font-medium my-1">${item.org}</p>
                            <p class="text-gray-600 mt-2"><strong>Ansprechpartner:</strong> ${item.contacts}</p>
                            <p class="text-gray-600 mt-1"><strong>Adresse:</strong> ${item.address}</p>
                        `;
                        resultsGrid.appendChild(card);
                    });
                }
            }

            function updateDashboard(filteredData) {
                statsCount.textContent = filteredData.length;

                const orgCounts = filteredData.reduce((acc, item) => {
                    acc[item.org] = (acc[item.org] || 0) + 1;
                    return acc;
                }, {});

                const chartLabels = Object.keys(orgCounts);
                const chartData = Object.values(orgCounts);

                if (chart) {
                    chart.destroy();
                }
                
                chart = new Chart(orgChartCanvas, {
                    type: 'doughnut',
                    data: {
                        labels: chartLabels,
                        datasets: [{
                            label: 'Anzahl Einrichtungen',
                            data: chartData,
                            backgroundColor: [
                                'rgba(217, 119, 6, 0.7)', 
                                'rgba(251, 191, 36, 0.7)',
                                'rgba(120, 113, 108, 0.7)',
                                'rgba(168, 162, 158, 0.7)',
                                'rgba(245, 158, 11, 0.7)',
                                'rgba(252, 211, 77, 0.7)',
                                'rgba(234, 179, 8, 0.7)',
                            ],
                             borderColor: [
                                'rgba(217, 119, 6, 1)', 
                                'rgba(251, 191, 36, 1)',
                                'rgba(120, 113, 108, 1)',
                                'rgba(168, 162, 158, 1)',
                                'rgba(245, 158, 11, 1)',
                                'rgba(252, 211, 77, 1)',
                                'rgba(234, 179, 8, 1)',
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'right',
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        let label = context.label || '';
                                        if (label) {
                                            label += ': ';
                                        }
                                        if (context.parsed !== null) {
                                            label += context.parsed;
                                        }
                                        return label;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            function filterAndRender() {
                const searchTerm = searchInput.value.toLowerCase();
                const selectedOrg = orgFilter.value;
                const selectedCity = cityFilter.value;

                const filteredData = data.filter(item => {
                    const nameMatch = item.name.toLowerCase().includes(searchTerm);
                    const contactsMatch = item.contacts.toLowerCase().includes(searchTerm);
                    const orgMatch = !selectedOrg || item.org === selectedOrg;
                    const cityMatch = !selectedCity || getCityFromAddress(item.address) === selectedCity;

                    return (nameMatch || contactsMatch) && orgMatch && cityMatch;
                });

                renderResults(filteredData);
                updateDashboard(filteredData);
            }

            searchInput.addEventListener('input', filterAndRender);
            orgFilter.addEventListener('change', filterAndRender);
            cityFilter.addEventListener('change', filterAndRender);

            filterAndRender();
        });
    </script>
</body>
</html>
